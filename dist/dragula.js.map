{"version":3,"sources":["../src/dragula.ts"],"sourcesContent":["import { DragulaContainers, DragulaOptions } from './interfaces';\n\nconst { documentElement } = document;\n\nclass Dragula extends EventTarget {\n  constructor(initialContainers: DragulaContainers | DragulaContainers[], options: DragulaOptions) {\n    super();\n\n    const len = arguments.length;\n    if (len === 1 && Array.isArray(initialContainers) === false) {\n      // [options, initialContainers] = [initialContainers, []];\n    } else {\n    }\n\n    const o = (this.options = { ...Dragula.defaultOptions, ...options });\n    this.containers = o.containers = o.containers || initialContainers || [];\n\n    if (typeof o.copy !== 'function') {\n      const { copy } = o;\n      o.copy = () => copy;\n    }\n\n    this.dragging = false;\n\n    let _mirror; // mirror image\n    let _source; // source container\n    let _item; // item being dragged\n    let _offsetX; // reference x\n    let _offsetY; // reference y\n    let _moveX; // reference move x\n    let _moveY; // reference move y\n    let _initialSibling; // reference sibling when grabbed\n    let _currentSibling; // reference sibling now\n    let _copy; // item used for copying\n    let _renderTimer; // timer for setTimeout renderMirrorImage\n    let _lastDropTarget = null; // last container item was over\n    let _grabbed; // holds pointerdown context until first pointermove\n    const drake = this;\n\n    if (drake.options.removeOnSpill === true) {\n      drake.on('over', spillOver).on('out', spillOut);\n    }\n\n    events();\n\n    Object.assign(this, {\n      start: manualStart,\n      end,\n      cancel,\n      remove,\n      destroy,\n      canMove,\n    });\n\n    function isContainer(el) {\n      return drake.containers.includes(el) || drake.options.isContainer(el);\n    }\n\n    function events(isRemove) {\n      const op = isRemove ? 'remove' : 'add';\n      documentElement[`${op}EventListener`]('pointerdown', grab);\n      documentElement[`${op}EventListener`]('pointerup', release);\n    }\n\n    function eventualMovements(isRemove) {\n      const op = isRemove ? 'remove' : 'add';\n      documentElement[`${op}EventListener`]('pointermove', startBecauseMouseMoved);\n    }\n\n    function movements(isRemove) {\n      const op = isRemove ? 'remove' : 'add';\n      documentElement[`${op}EventListener`]('selectstart', preventGrabbed); // IE8\n      documentElement[`${op}EventListener`]('click', preventGrabbed);\n    }\n\n    function destroy() {\n      events(true);\n      release({});\n    }\n\n    function preventGrabbed(e) {\n      if (_grabbed) {\n        e.preventDefault();\n      }\n    }\n\n    function grab(e) {\n      _moveX = e.clientX;\n      _moveY = e.clientY;\n\n      const ignore = whichMouseButton(e) !== 1 || e.metaKey || e.ctrlKey;\n      if (ignore) {\n        return; // we only care about honest-to-god left clicks and touch events\n      }\n      const item = e.target;\n      const context = canStart(item);\n      if (!context) {\n        return;\n      }\n      _grabbed = context;\n      eventualMovements();\n      if (e.type === 'pointerdown') {\n        if (isInput(item)) {\n          // see also: https://github.com/bevacqua/dragula/issues/208\n          item.focus(); // fixes https://github.com/bevacqua/dragula/issues/176\n        } else {\n          e.preventDefault(); // fixes https://github.com/bevacqua/dragula/issues/155\n        }\n      }\n    }\n\n    function startBecauseMouseMoved(e) {\n      if (!_grabbed) {\n        return;\n      }\n      if (whichMouseButton(e) === 0) {\n        release({});\n        // when text is selected on an input and then dragged, pointerup doesn't fire.\n        // this is our only hope\n        return;\n      }\n\n      // truthy check fixes #239, equality fixes #207, fixes #501\n      if (\n        e.clientX !== undefined &&\n        Math.abs(e.clientX - _moveX) <= (drake.options.slideFactorX || 0) &&\n        e.clientY !== undefined &&\n        Math.abs(e.clientY - _moveY) <= (drake.options.slideFactorY || 0)\n      ) {\n        return;\n      }\n\n      if (drake.options.ignoreInputTextSelection) {\n        const clientX = e.clientX || 0;\n        const clientY = e.clientY || 0;\n        const elementBehindCursor = document.elementFromPoint(clientX, clientY);\n\n        if (isInput(elementBehindCursor)) {\n          return;\n        }\n      }\n\n      const grabbed = _grabbed; // call to end() unsets _grabbed\n      eventualMovements(true);\n      movements();\n      end();\n      start(grabbed);\n\n      const offset = getOffset(_item);\n      _offsetX = e.pageX - offset.left;\n      _offsetY = e.pageY - offset.top;\n\n      const inTransit = _copy || _item;\n      if (inTransit) {\n        inTransit.classList.add('gu-transit');\n      }\n      renderMirrorImage();\n      drag(e);\n    }\n\n    function canStart(item) {\n      if (drake.dragging && _mirror) {\n        return;\n      }\n      if (isContainer(item)) {\n        return; // don't drag container itself\n      }\n      const handle = item;\n      while (getParent(item) && isContainer(getParent(item)) === false) {\n        if (drake.options.invalid(item, handle)) {\n          return;\n        }\n        item = getParent(item); // drag target should be a top element\n        if (!item) {\n          return;\n        }\n      }\n      const source = getParent(item);\n      if (!source) {\n        return;\n      }\n      if (drake.options.invalid(item, handle)) {\n        return;\n      }\n\n      const movable = drake.options.moves(item, source, handle, item.nextElementSibling);\n      if (!movable) {\n        return;\n      }\n\n      return {\n        item,\n        source,\n      };\n    }\n\n    function canMove(item) {\n      return !!canStart(item);\n    }\n\n    function manualStart(item) {\n      const context = canStart(item);\n      if (context) {\n        start(context);\n      }\n    }\n\n    function start(context) {\n      if (drake.options.copy(context.item, context.source)) {\n        _copy = context.item.cloneNode(true);\n        drake.emit('cloned', {\n          clone: _copy,\n          original: context.item,\n          type: 'copy',\n        });\n      }\n\n      _source = context.source;\n      _item = context.item;\n      _initialSibling = _currentSibling = context.item.nextElementSibling;\n\n      drake.dragging = true;\n      drake.emit('drag', _item, _source);\n    }\n\n    function end() {\n      if (!drake.dragging) {\n        return;\n      }\n      const item = _copy || _item;\n      drop(item, getParent(item));\n    }\n\n    function ungrab() {\n      _grabbed = false;\n      eventualMovements(true);\n      movements(true);\n    }\n\n    function release(e) {\n      ungrab();\n\n      if (!drake.dragging) {\n        return;\n      }\n      const item = _copy || _item;\n      const clientX = e.clientX || 0;\n      const clientY = e.clientY || 0;\n      const elementBehindCursor = getElementBehindPoint(_mirror, clientX, clientY);\n      const dropTarget = findDropTarget(elementBehindCursor, clientX, clientY);\n\n      if (dropTarget && ((_copy && drake.options.copySortSource) || !_copy || dropTarget !== _source)) {\n        drop(item, dropTarget);\n      } else if (drake.options.removeOnSpill) {\n        remove();\n      } else {\n        cancel();\n      }\n    }\n\n    function drop(item, target) {\n      if (_copy && drake.options.copySortSource && target === _source) {\n        _item.remove();\n      }\n      if (isInitialPlacement(target)) {\n        drake.emit('cancel', {\n          element: item,\n          container: _source,\n          source: _source,\n        });\n      } else {\n        drake.emit('drop', {\n          element: item,\n          target,\n          source: _source,\n          sibling: _currentSibling,\n        });\n      }\n\n      cleanup();\n    }\n\n    function remove() {\n      if (!drake.dragging) {\n        return;\n      }\n      const item = _copy || _item;\n      const parent = getParent(item);\n      if (parent) {\n        item.remove();\n      }\n      drake.emit(_copy ? 'cancel' : 'remove', {\n        element: item,\n        container: parent,\n        source: _source,\n      });\n\n      cleanup();\n    }\n\n    function cancel(revert) {\n      if (!drake.dragging) {\n        return;\n      }\n      const reverts = arguments.length > 0 ? revert : drake.options.revertOnSpill;\n      const item = _copy || _item;\n      const parent = getParent(item);\n      const initial = isInitialPlacement(parent);\n      if (initial === false && reverts) {\n        if (_copy) {\n          if (parent) {\n            _copy.remove();\n          }\n        } else {\n          _source.insertBefore(item, _initialSibling);\n        }\n      }\n      if (initial || reverts) {\n        drake.emit('cancel', {\n          element: item,\n          container: _source,\n          source: _source,\n        });\n      } else {\n        drake.emit('drop', {\n          element: item,\n          target: parent,\n          source: _source,\n          sibling: _currentSibling,\n        });\n      }\n\n      cleanup();\n    }\n\n    function cleanup() {\n      const item = _copy || _item;\n      ungrab();\n      removeMirrorImage();\n      if (item) {\n        item.classList.remove('gu-transit');\n      }\n      if (_renderTimer) {\n        clearTimeout(_renderTimer);\n      }\n      drake.dragging = false;\n      if (_lastDropTarget) {\n        drake.emit('out', {\n          element: item,\n          container: _lastDropTarget,\n          source: _source,\n        });\n      }\n      drake.emit('dragend', { element: item });\n      _source = _item = _copy = _initialSibling = _currentSibling = _renderTimer = _lastDropTarget = null;\n    }\n\n    function isInitialPlacement(target, s) {\n      let sibling;\n      if (s !== undefined) {\n        sibling = s;\n      } else if (_mirror) {\n        sibling = _currentSibling;\n      } else {\n        sibling = (_copy || _item).nextElementSibling;\n      }\n      return target === _source && sibling === _initialSibling;\n    }\n\n    function findDropTarget(elementBehindCursor, clientX, clientY) {\n      let target = elementBehindCursor;\n\n      function accepted() {\n        const droppable = isContainer(target);\n        if (droppable === false) {\n          return false;\n        }\n\n        const immediate = getImmediateChild(target, elementBehindCursor);\n        const reference = getReference(target, immediate, clientX, clientY, drake.options.direction);\n        const initial = isInitialPlacement(target, reference);\n        if (initial) {\n          return true; // should always be able to drop it right back where it was\n        }\n\n        return drake.options.accepts(_item, target, _source, reference);\n      }\n\n      while (target && !accepted()) {\n        target = getParent(target);\n      }\n\n      return target;\n    }\n\n    function drag(e) {\n      if (!_mirror) {\n        return;\n      }\n      e.preventDefault();\n\n      const clientX = e.clientX || 0;\n      const clientY = e.clientY || 0;\n      const x = clientX - _offsetX;\n      const y = clientY - _offsetY;\n\n      _mirror.style.left = `${x}px`;\n      _mirror.style.top = `${y}px`;\n\n      const item = _copy || _item;\n      const elementBehindCursor = getElementBehindPoint(_mirror, clientX, clientY);\n      let dropTarget = findDropTarget(elementBehindCursor, clientX, clientY);\n      const changed = dropTarget !== null && dropTarget !== _lastDropTarget;\n      if (changed || dropTarget === null) {\n        out();\n        _lastDropTarget = dropTarget;\n        over();\n      }\n\n      const parent = getParent(item);\n      if (dropTarget === _source && _copy && !drake.options.copySortSource) {\n        if (parent) {\n          item.remove();\n        }\n\n        return;\n      }\n\n      let reference;\n      const immediate = getImmediateChild(dropTarget, elementBehindCursor);\n      if (immediate !== null) {\n        reference = getReference(dropTarget, immediate, clientX, clientY, drake.options.direction);\n      } else if (drake.options.revertOnSpill === true && !_copy) {\n        reference = _initialSibling;\n        dropTarget = _source;\n      } else {\n        if (_copy && parent) {\n          item.remove();\n        }\n\n        return;\n      }\n\n      // eslint-disable-next-line max-len\n      if ((reference === null && changed) || (reference !== item && reference !== item.nextElementSibling)) {\n        _currentSibling = reference;\n        dropTarget.insertBefore(item, reference);\n        drake.emit('shadow', {\n          element: item,\n          container: dropTarget,\n          source: _source,\n        });\n      }\n\n      function moved(type) {\n        drake.emit(type, {\n          element: item,\n          container: _lastDropTarget,\n          source: _source,\n        });\n      }\n      function over() {\n        if (changed) {\n          moved('over');\n        }\n      }\n      function out() {\n        if (_lastDropTarget) {\n          moved('out');\n        }\n      }\n    }\n\n    function spillOver(el) {\n      if (el) {\n        el.classList.remove('gu-hide');\n      }\n    }\n\n    function spillOut(el) {\n      if (el && drake.dragging) {\n        el.classList.add('gu-hide');\n      }\n    }\n\n    function renderMirrorImage() {\n      if (_mirror) {\n        return;\n      }\n\n      const rect = _item.getBoundingClientRect();\n      _mirror = _item.cloneNode(true);\n      _mirror.style.width = `${rect.width}px`;\n      _mirror.style.height = `${rect.height}px`;\n      _mirror.classList.remove('gu-transit');\n      _mirror.classList.add('gu-mirror');\n      drake.options.mirrorContainer.appendChild(_mirror);\n      documentElement.addEventListener('pointermove', drag);\n      drake.options.mirrorContainer.classList.add('gu-unselectable');\n      drake.emit('cloned', {\n        clone: _mirror,\n        original: _item,\n        type: 'mirror',\n      });\n    }\n\n    function removeMirrorImage() {\n      if (_mirror) {\n        drake.options.mirrorContainer.classList.remove('gu-unselectable');\n        documentElement.removeEventListener('pointermove', drag);\n        _mirror.remove();\n        _mirror = null;\n      }\n    }\n  } // End constructor\n\n  on(eventType, callback) {\n    this.addEventListener(eventType, (evt) => {\n      callback.call(this, ...Object.values(evt.detail));\n    });\n\n    return this;\n  }\n\n  off(eventType, callback) {\n    this.removeEventListener(eventType, callback);\n\n    return this;\n  }\n\n  emit(eventType, detail, ...args) {\n    if (detail instanceof Node) {\n      // Old syntax with positional arguments\n      detail = [detail, ...args];\n    }\n    const evt = new CustomEvent(eventType, { detail });\n    this.dispatchEvent(evt);\n    return this;\n  }\n\n  static defaultOptions = {\n    moves: () => true,\n    accepts: () => true,\n    invalid: () => false,\n    isContainer: () => false,\n    copy: false,\n    copySortSource: false,\n    revertOnSpill: false,\n    removeOnSpill: false,\n    direction: 'vertical',\n    ignoreInputTextSelection: true,\n    mirrorContainer: document.body,\n  };\n}\n\nfunction dragula(...args) {\n  return new Dragula(...args);\n}\n\nfunction whichMouseButton(e) {\n  if (e.touches !== undefined) {\n    return e.touches.length;\n  }\n  if (e.which !== undefined && e.which !== 0) {\n    return e.which;\n  } // see https://github.com/bevacqua/dragula/issues/261\n  if (e.buttons !== undefined) {\n    return e.buttons;\n  }\n\n  const { button } = e;\n  if (button !== undefined) {\n    // see https://github.com/jquery/jquery/blob/99e8ff1baa7ae341e94bb89c3e84570c7c3ad9ea/src/event.js#L573-L575\n    return button & 1 ? 1 : button & 2 ? 3 : button & 4 ? 2 : 0;\n  }\n}\n\nfunction getOffset(el) {\n  const rect = el.getBoundingClientRect();\n  return {\n    left: rect.left + window.scrollX,\n    top: rect.top + window.scrollY,\n  };\n}\n\nfunction getElementBehindPoint(point, x, y) {\n  point = point || {};\n  const state = point.className || '';\n  point.className += ' gu-hide';\n  const el = document.elementFromPoint(x, y);\n  point.className = state;\n\n  return el;\n}\n\nfunction getParent(el) {\n  return el.parentNode === document ? null : el.parentNode;\n}\n\nfunction isEditable(el) {\n  if (!el) {\n    return false;\n  } // no parents were editable\n  if (el.contentEditable === 'false') {\n    return false;\n  } // stop the lookup\n  if (el.contentEditable === 'true') {\n    return true;\n  } // found a contentEditable element in the chain\n\n  return isEditable(getParent(el)); // contentEditable is set to 'inherit'\n}\n\nfunction isInput(el) {\n  return el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT' || isEditable(el);\n}\n\nfunction getImmediateChild(dropTarget, target) {\n  let immediate = target;\n  while (immediate !== dropTarget && getParent(immediate) !== dropTarget) {\n    immediate = getParent(immediate);\n  }\n\n  if (immediate === documentElement) {\n    return null;\n  }\n\n  return immediate;\n}\n\nfunction getReference(dropTarget, target, x, y, direction) {\n  const horizontal = direction === 'horizontal';\n\n  function resolve(after) {\n    return after ? target.nextElementSibling : target;\n  }\n\n  function inside() {\n    // faster, but only available if dropped inside a child element\n    const rect = target.getBoundingClientRect();\n    if (horizontal) {\n      return resolve(x > rect.left + rect.width / 2);\n    }\n\n    return resolve(y > rect.top + rect.height / 2);\n  }\n\n  function outside() {\n    // slower, but able to figure out any position\n    const countChildren = dropTarget.children.length;\n    let i;\n    let el;\n    let rect;\n    for (i = 0; i < countChildren; i++) {\n      el = dropTarget.children[i];\n      rect = el.getBoundingClientRect();\n      if (horizontal && rect.left + rect.width / 2 > x) {\n        return el;\n      }\n      if (!horizontal && rect.top + rect.height / 2 > y) {\n        return el;\n      }\n    }\n\n    return null;\n  }\n\n  return target !== dropTarget ? inside() : outside();\n}\n\nmodule.exports = dragula;\n"],"names":["documentElement","document","Dragula","initialContainers","options","isContainer","el","drake","containers","includes","events","isRemove","op","grab","release","eventualMovements","startBecauseMouseMoved","movements","preventGrabbed","destroy","e","_grabbed","preventDefault","_moveX","clientX","_moveY","clientY","ignore","whichMouseButton","metaKey","ctrlKey","item","target","context","canStart","type","isInput","focus","undefined","Math","abs","slideFactorX","slideFactorY","ignoreInputTextSelection","elementBehindCursor","elementFromPoint","grabbed","end","start","offset","getOffset","_item","_offsetX","pageX","left","_offsetY","pageY","top","inTransit","_copy","classList","add","renderMirrorImage","drag","dragging","_mirror","handle","getParent","invalid","source","movable","moves","nextElementSibling","canMove","manualStart","copy","cloneNode","emit","clone","original","_source","_initialSibling","_currentSibling","drop","ungrab","getElementBehindPoint","dropTarget","findDropTarget","copySortSource","removeOnSpill","remove","cancel","isInitialPlacement","element","container","sibling","cleanup","parent","revert","reverts","arguments","length","revertOnSpill","initial","insertBefore","removeMirrorImage","_renderTimer","clearTimeout","_lastDropTarget","s","accepted","droppable","immediate","getImmediateChild","reference","getReference","direction","accepts","x","y","style","changed","out","over","moved","spillOver","spillOut","rect","getBoundingClientRect","width","height","mirrorContainer","appendChild","addEventListener","removeEventListener","len","Array","isArray","o","defaultOptions","on","Object","assign","eventType","callback","evt","call","values","detail","off","args","Node","CustomEvent","dispatchEvent","EventTarget","body","dragula","touches","which","buttons","button","window","scrollX","scrollY","point","state","className","parentNode","isEditable","contentEditable","tagName","resolve","after","inside","horizontal","outside","countChildren","children","i","module","exports"],"mappings":"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"}